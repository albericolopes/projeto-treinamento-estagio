<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://xmlns.jcp.org/jsf/core">

<h:head>
	<title>Cadastro de Times</title>
</h:head>

<h:body>

	<!-- Botão Voltar -->
	<h:form>
		<div style="padding: 10px; background-color: #f8f9fa;">
			<p:commandButton value="Voltar ao Menu"
				action="index?faces-redirect=true" icon="pi pi-arrow-left"
				styleClass="p-button-outlined p-button-secondary" />
		</div>
	</h:form>

	<p:growl id="messages" showDetail="true" life="4000" />

	<!-- FORM: Cadastro -->
	<h:form id="teamForm">
		<p:panel header="Cadastro de Time" style="margin-bottom:20px;">
			<h:panelGrid columns="2" columnClasses="p-col-12 p-md-4 p-field"
				styleClass="p-fluid p-formgrid p-grid">

				<p:outputLabel for="name" value="Nome:" />
				<p:inputText id="name" value="#{teamMB.team.name}" required="true"
					requiredMessage="Nome é obrigatório" />

				<p:outputLabel for="city" value="Cidade:" />
				<p:inputText id="city" value="#{teamMB.team.city}" required="true"
					requiredMessage="Cidade é obrigatória" />

				<p:outputLabel for="stadium" value="Estádio:" />
				<p:inputText id="stadium" value="#{teamMB.team.stadium}"
					required="false" />

			</h:panelGrid>

			<p:commandButton value="Salvar" action="#{teamMB.saveTeam}"
				update=":tableForm:teamsTable :messages" icon="pi pi-save"
				disableOnClick="true" />

			<p:commandButton value="Novo" action="#{teamMB.prepareNewTeam}"
				update="name city stadium" icon="pi pi-plus"
				styleClass="p-button-secondary" />
		</p:panel>
	</h:form>

	<!-- FORM: Busca -->
	<h:form id="searchForm">
		<p:panel header="Buscar Times">
			<p:toolbar>
				<p:toolbarGroup>
					<!-- Nome -->
					<p:inputText id="searchNameInput" value="#{teamMB.searchName}"
						placeholder="Buscar por nome" style="width:250px;" />

					<!-- Cidade -->
					<p:inputText id="searchCityInput" value="#{teamMB.searchCity}"
						placeholder="Buscar por cidade"
						style="width:250px; margin-left: 10px;" />

					<!-- Botão Buscar -->
					<p:commandButton value="Buscar" action="#{teamMB.findTeams}"
						update=":tableForm:teamsTable :messages" icon="pi pi-search"
						process="@this searchNameInput searchCityInput"
						style="margin-left: 10px;" />
				</p:toolbarGroup>

				<p:toolbarGroup align="right">
					<!-- Botão Limpar Filtros -->
					<p:commandButton value="Limpar Filtros"
						action="#{teamMB.clearFilters}"
						update=":tableForm:teamsTable :messages searchNameInput searchCityInput"
						icon="pi pi-times" styleClass="p-button-warning"
						style="margin-right: 10px;" />

					<!-- Botão Mostrar Todos -->
					<p:commandButton value="Mostrar Todos"
						action="#{teamMB.loadAllTeams}"
						update=":tableForm:teamsTable :messages" icon="pi pi-list"
						styleClass="p-button-secondary" />
				</p:toolbarGroup>
			</p:toolbar>
		</p:panel>
	</h:form>

	<!--Tabela de times -->
	<h:form id="tableForm">
		<p:dataTable id="teamsTable" value="#{teamMB.teams}" var="t"
			paginator="true" rows="10" emptyMessage="Nenhum time encontrado."
			style="margin-top:10px">

			<p:column headerText="Nome">
				<h:outputText value="#{t.name}" />
			</p:column>

			<p:column headerText="Cidade">
				<h:outputText value="#{t.city}" />
			</p:column>

			<p:column headerText="Estádio">
				<h:outputText value="#{t.stadium}" />
			</p:column>

			<p:column headerText="Ações" style="width:120px; text-align:center;">
				<p:commandButton icon="pi pi-pencil" action="#{teamMB.editTeam(t)}"
					update=":teamForm:name :teamForm:city :teamForm:stadium"
					process="@this" title="Editar"
					styleClass="p-button-rounded p-button-success p-button-outlined" />
				<p:commandButton icon="pi pi-trash" process="@this"
					oncomplete="PF('deleteTeamDialog').show()"
					styleClass="p-button-danger p-button-rounded p-button-outlined"
					title="Excluir">
					<f:setPropertyActionListener value="#{t}"
						target="#{teamMB.teamToDelete}" />
				</p:commandButton>
			</p:column>
		</p:dataTable>
	</h:form>

	<!-- DIALOGO DE CONFIRMAÇÃO DE EXCLUSÃO -->
	<h:form id="confirmDialogForm">
		<p:confirmDialog widgetVar="deleteTeamDialog"
			header="Confirmação de Exclusão"
			message="Deseja realmente excluir este time?"
			icon="pi pi-exclamation-triangle" closable="false" resizable="false"
			draggable="false" width="400">

			<p:commandButton value="Sim" action="#{teamMB.deleteTeam}"
				process="@form" update=":tableForm:teamsTable :messages"
				oncomplete="PF('deleteTeamDialog').hide()"
				styleClass="p-button-danger" />

			<p:commandButton value="Cancelar" type="button"
				onclick="PF('deleteTeamDialog').hide()"
				styleClass="p-button-secondary" />
		</p:confirmDialog>
	</h:form>

</h:body>
</html>